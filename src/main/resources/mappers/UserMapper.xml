<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dilsonjlrjr.javatrellodashboardmateus.mapper.UserMapper">

    <resultMap id="resultMapUser" type="com.dilsonjlrjr.javatrellodashboardmateus.model.entities.User">
        <id column="id" property="id" />
        <result property="name" column="name" />
        <result property="email" column="email" />
        <result property="username" column="username" />
        <result property="password" column="password" />
        <result property="refreshToken" column="refresh_token" />
        <result property="hashSession" column="hash_session" />
    </resultMap>

    <update id="updateSessionUser">
        update 	database.users
        set  	refresh_token = #{refreshToken}, hash_session = #{hashSession}
        where	id = #{id};
    </update>

    <sql id="headerDefaultUser">
        select  id, "name", username, email, "password", refresh_token, hash_session
        from    database.users
    </sql>

    <select id="findByUsername" resultMap="resultMapUser">
        <include refid="headerDefaultUser" />
        where   username = #{username}
    </select>

    <select id="findByRefreshTokenHashSession" resultMap="resultMapUser">
        <include refid="headerDefaultUser" />
        where   refresh_token = #{refreshToken}
                and hash_session = #{hashSession}
    </select>

    <select id="findAll" resultMap="resultMapUser">
        <include refid="headerDefaultUser" />
    </select>

    <select id="findById" resultMap="resultMapUser">
        <include refid="headerDefaultUser" />
        where   id = #{id}
    </select>
</mapper>